# Анализ ASN по IP-адресам

Задача: определить принадлежность IP-адресов к автономным системам (ASN) для анализа сетевой активности пользователей и резолверов DNS. В целом используем лог нашего DNS-сервера(авторитетного) и сторонние сервисы для опредления ASN или RADB.

---

## Реализовано два подхода

### 1. `asn_lookup_teamcymru.py`

- Использует публичный сервис **Team Cymru WHOIS** для быстрого пакетного сопоставления IP → ASN.
- Подходит для анализа больших логов (например, query.log от BIND).
- Даёт краткую статистику (ASN, организация, количество запросов).

Пример запуска:

```bash
python3 asn_lookup_teamcymru.py
```

---

### 2. `asn_lookup.py`

- Использует библиотеку **ipwhois** и протокол **RDAP**.
- Не зависит от внешнего сервиса Team Cymru.
- Позволяет выполнять точечные запросы для отдельных IP.

Пример запуска:

```bash
python3 asn_lookup.py 8.8.8.8 1.1.1.1 77.88.8.8
```

## Итог

- Первый скрипт удобен для массового анализа логов DNS.  
- Второй подходит для автономных проверок и валидации через официальные RDAP-сервисы.  

Оба инструмента используются в проекте для получения более полной картины распределения IP по автономным системам.
